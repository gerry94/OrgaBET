<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorate="~{default}">
   <head>
      <title th:utext="${title}"></title>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
      <link rel="stylesheet" type="text/css" media="all" href="../static/css/style.css" th:href="@{/css/style.css}" />
   </head>
    
   <style>
      table th, table td {
         padding: 5px;
      }
   </style>
    
   <body>
      <!-- Include _menu.html -->
      <div layout:fragment="content">
          <div id="wrapper">
          <div id="tableDiv">
             <h2>Matches</h2>
            <table id="matchTable" border="1">
                <thead>
                    <tr>
                        <th>TIME</th>
                        <th>HOME TEAM</th>
                        <th>AWAY TEAM</th>
                        <th>1</th>
                        <th>X</th>
                        <th>2</th>
                        <th>OVER 2.5</th>
                        <th>UNDER 2.5</th>
                    </tr>
                </thead>
                <tbody>
                    <tr th:each ="tbl : ${matches}">
                    <td th:utext="${tbl.match.Time}">...</td>
                    <td th:utext="${tbl.match.homeTeam}">...</td>
                    <td th:utext="${tbl.match.awayTeam}">...</td>
                    <td class="quoteArea" th:each="a: ${tbl.avg}" th:if="${a.id == 'H'}"
                        th:text="${#numbers.formatDecimal(a.avg, 0, 2)}" th:matchId="${tbl.match.id}" th:onclick="javascript:printOdd(this, this.getAttribute('matchId'));">...</td>
                    <td class="quoteArea" th:each="a: ${tbl.avg}" th:if="${a.id == 'D'}"
                        th:text="${#numbers.formatDecimal(a.avg, 0, 2)}" th:matchId="${tbl.match.id}" th:onclick="javascript:printOdd(this, this.getAttribute('matchId'));">...</td>
                    <td class="quoteArea" th:each="a: ${tbl.avg}" th:if="${a.id == 'A'}"
                        th:text="${#numbers.formatDecimal(a.avg, 0, 2)}" th:matchId="${tbl.match.id}" th:onclick="javascript:printOdd(this, this.getAttribute('matchId'));">...</td>
                    <td class="quoteArea" th:each="a: ${tbl.avg}" th:if="${a.id == 'OVER'}"
                        th:text="${#numbers.formatDecimal(a.avg, 0, 2)}" th:matchId="${tbl.match.id}" th:onclick="javascript:printOdd(this, this.getAttribute('matchId'));">...</td>
                    <td class="quoteArea" th:each="a: ${tbl.avg}" th:if="${a.id == 'UNDER'}"
                        th:text="${#numbers.formatDecimal(a.avg, 0, 2)}" th:matchId="${tbl.match.id}" th:onclick="javascript:printOdd(this, this.getAttribute('matchId'));">...</td>
                    </tr>
                </tbody>
            </table>
             <script type="text/javascript" th:inline="javascript">
                function printOdd(elem, matchId) {
                   /*var tableRow = elem.parentNode;
                   var homeTeam = tableRow.cells[1].textContent;
                   var awayTeam = tableRow.cells[2].textContent;*/

                   //get the type of bet you are placing (get corresponding <th> to this clicked <td> element)
                   var index = Array.prototype.indexOf.call(elem.parentNode.children, elem);
                   var oddType = document.querySelector('#matchTable th:nth-child(' + (index+1) + ')').textContent;

                   switch(oddType){
                       case "1":
                           oddType="H";
                           break;
                       case "X":
                           oddType = "D";
                           break;
                       case "2":
                           oddType = "A";
                           break;
                       case "OVER 2.5":
                           oddType = "OVER";
                           break;
                       case "UNDER 2.5":
                           oddType = "UNDER";
                           break;
                   }
                   $.ajax({
                      type: "POST",
                      url: "/printQuote",
                      data: {id:matchId, type:oddType} //, home:homeTeam, away:awayTeam, type:oddType, avgQuote:elem.textContent}
                   });
                }
             </script>
          </div>

          <div id="coupon" class="coupon">
             <th:block th:include="fragments/coupon :: coupon">
             </th:block>
          </div>
       </div>
      </div>
   
   </body>
</html>